{
  "table_name": "scor_metric_observations",
  "class_name": "SCORMetricObservation",
  "is_hypertable": true,
  "time_column": "timestamp",
  "partition_interval": "1 day",
  "columns": [
    {
      "name": "id",
      "type": "Integer",
      "primary_key": true,
      "autoincrement": true
    },
    {
      "name": "timestamp",
      "type": "DateTime",
      "nullable": false,
      "index": true,
      "description": "When the metric was observed/calculated"
    },
    {
      "name": "scor_metric_id",
      "type": "String",
      "length": 50,
      "nullable": false,
      "index": true,
      "description": "SCOR metric identifier (e.g., 'RL.1.1', 'RS.1.1')"
    },
    {
      "name": "kpi_code",
      "type": "String",
      "length": 100,
      "index": true,
      "description": "Associated KPI code (e.g., 'PERFECT_ORDER_FULFILLMENT')"
    },
    {
      "name": "value",
      "type": "Float",
      "nullable": false,
      "description": "Metric value"
    },
    {
      "name": "unit",
      "type": "String",
      "length": 50,
      "description": "Unit of measurement (e.g., 'percentage', 'days', 'dollars')"
    },
    {
      "name": "observation_period_start",
      "type": "DateTime",
      "description": "Start of the period this observation covers"
    },
    {
      "name": "observation_period_end",
      "type": "DateTime",
      "description": "End of the period this observation covers"
    },
    {
      "name": "organization_id",
      "type": "Integer",
      "index": true,
      "description": "Organization/client this observation belongs to"
    },
    {
      "name": "process_id",
      "type": "String",
      "length": 50,
      "index": true,
      "description": "SCOR process this metric is associated with (e.g., 'P1', 'S1')"
    },
    {
      "name": "context",
      "type": "JSON",
      "description": "Additional dimensions and context (region, product_line, facility, etc.)"
    },
    {
      "name": "data_source",
      "type": "String",
      "length": 100,
      "description": "Source of the data (e.g., 'calculated', 'manual_entry', 'imported')"
    },
    {
      "name": "confidence_level",
      "type": "Float",
      "description": "Confidence level in the observation (0.0 to 1.0)"
    },
    {
      "name": "notes",
      "type": "Text",
      "description": "Additional notes or comments about this observation"
    },
    {
      "name": "created_at",
      "type": "DateTime",
      "default": "now()",
      "nullable": false
    },
    {
      "name": "updated_at",
      "type": "DateTime",
      "default": "now()",
      "onupdate": "now()",
      "nullable": false
    }
  ],
  "indexes": [
    {
      "name": "ix_scor_metric_observations_timestamp",
      "columns": [
        "timestamp"
      ],
      "description": "Primary time-series index"
    },
    {
      "name": "ix_scor_metric_observations_scor_metric_id",
      "columns": [
        "scor_metric_id"
      ],
      "description": "Index for filtering by SCOR metric"
    },
    {
      "name": "ix_scor_metric_observations_kpi_code",
      "columns": [
        "kpi_code"
      ],
      "description": "Index for filtering by KPI"
    },
    {
      "name": "ix_scor_metric_observations_organization_id",
      "columns": [
        "organization_id"
      ],
      "description": "Index for multi-tenant filtering"
    },
    {
      "name": "ix_scor_metric_observations_process_id",
      "columns": [
        "process_id"
      ],
      "description": "Index for filtering by SCOR process"
    },
    {
      "name": "ix_scor_metric_observations_composite",
      "columns": [
        "scor_metric_id",
        "timestamp",
        "organization_id"
      ],
      "description": "Composite index for common query patterns"
    }
  ],
  "constraints": [
    {
      "type": "check",
      "name": "chk_value_positive",
      "expression": "value >= 0",
      "description": "Ensure metric values are non-negative"
    },
    {
      "type": "check",
      "name": "chk_confidence_range",
      "expression": "confidence_level IS NULL OR (confidence_level >= 0 AND confidence_level <= 1)",
      "description": "Ensure confidence level is between 0 and 1"
    }
  ]
}